<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Page Properties -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1,
    shrink-to-fit=no"
    />

    <!-- Site Title and Description -->
    <title>WebSocket Service</title>

    <!-- Scripts -->
    <script type="application/javascript" async defer>
      /**
       * Appends a string in a paragraph to the target element.
       *
       * Call this with 'bellboy-text' or 'website-text' to add 'log data'
       * to either the bellboy or website columns.
       */
      function addText(string, elementId) {
        var bb = document.getElementById(elementId);
        var msg = document.createElement("p");
        msg.innerText = string;
        bb.appendChild(msg);
        msg.scrollIntoView();
      }

      function setupBellboy() {
        // Creates a websocket connection as the bellboy.
        let bellboy = new WebSocket("ws://localhost:3000/");
        bellboy.onopen = function () {
          bellboy.send("Hello");
        };
      }

      function setupWebsite() {
        // Creates a websocket connection as the bellboy.
        let bellboy = new WebSocket("ws://localhost:3000/");
        bellboy.onopen = function () {
          bellboy.send("Hello");
        };
      }
      /*
       * On load operation. Calls a number of functions once the DOM is ready.
       * ALL features should be called in this block.
       */
      window.addEventListener("load", function (event) {
        // Feature functions:

        // Test logging
        for (var i = 0; i < 100; i++) {
          addText(i + " sent", "bellboy-text");
          addText(i + " received", "website-text");
        }

        setupBellboy();
        setupWebsite();
      });
    </script>

    <style>
      html,
      body {
        background: #aaa;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        height: 98%;
        overflow: hidden;
        text-align: left;
      }
      .container {
        display: flex;
        height: 98%;
      }
      .child {
        background: white;
        flex: 1;
        border: 2px solid black;
        padding: 5px;
        margin: 5px;
        height: 98%;
        display: block;
        border-radius: 8px;
      }
      .scroll-container {
        height: 80%;
        border: 1px solid #ddd;
        overflow-y: scroll;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="child">
        <h1>Bellboy</h1>
        <p>Log messages:</p>
        <div class="scroll-container">
          <div id="bellboy-text" class="scroll"></div>
        </div>
      </div>
      <div class="child">
        <h1>Website</h1>
        <p>Log messages:</p>
        <div class="scroll-container">
          <div id="website-text" class="scroll"></div>
        </div>
      </div>
    </div>
  </body>
</html>
